---
layout: post
title: "LOFTER迁移综合指北"
date:   2019-06-19
tags: [技术,翻墙]
comments: true
author: 来自中世界
toc: true
---
## 第一步 导出 


在网页版顶部菜单选择**更多-导入导出**，下载XML文档即可。

看起来很顺利的样子但是我要先吐槽一下LOFTER这个功能……我总觉得它是当年为了假装是个功能全面的博客服务才搞的，实际上网易的产品只想忽悠你从别处迁移到lofter去，没真正替你考虑怎么从lofter迁出来。

<!-- more -->

这个文档包含了你所有的文字po，图片只有URL，和评论内容，没有热度等信息。音乐会有链接。长文章……不知出于什么缘故，大概是网易的产品更新长文章功能的时候完全忘了这回事……除了封面图什么都没有。所以你要是想迁移很多长文章的话……这篇指北并帮不了你。

总之这个xml挺sucks的【。然后lofter也不是什么搞技术的人聚集的社区，所以写很少有人做第三方工具，因此……well，本文会说到我目前找到的所有相关转换方法，都有一定的局限且并非一键操作。

## 第二步 转换 


把这个xml变成一种可读或可再发布的格式，目前我所知有如下方案。

有一款WordPress插件……[cnblogs2wp](https://wordpress.org/plugins/cnblogs2wp/)。

技术上说这应该是个不错的方案，WordPress和插件本身都是免费的，而且我看到过的评价都是这这个插件挺好用。我一度想先导入WordPress，再从WordPress导出……这样大概相当于把一种神他妈小众的产品先转换为一般等价物，然后就哪哪都好使了。

当然理论是这样的。实际上怎样老实说我也不知道，在WordPress.com你要付费才能用插件，而自建的WordPress显然你就需要有个host……总之对于只是想通过它中转的需求来说，太重，太复杂，不值得。WordPress本身用作个人博客也已经开始显得太重，太复杂了。

但当然如果你已经有一个付费的WordPress.com账户或者自己的WordPress网站…………那你怎么还会需要看我这样半吊子写的指北！！！！~~方案一~~

方案二，是[墨问非名太太的脚本](https://github.com/alicewish/Lofter2Hexo)，我提到过许多次了。

说来这事有趣，因为它恰巧和另一个JS脚本的名字相同，都是LOFTER2hexo（只有大小写有区别），我一开始还以为是同一个……大概是因为Hexo确实比较流行？目前的最新版本我个人是发现会在某些博文处卡住不动，因为不懂python，加上图形界面的封装似乎没有添加具体的报错信息，暂时还不知道是什么缘故。

对了，这个脚本导出的md文档文章内容部分并不是Markdown格式，而是HTML，由于当然了Markdown可以解析HTML的标签，所以内容本身是没问题的。但是如果想要作为Markdown文档再编辑，就需要再进行一遍转换。

方案三，是我改的JS脚本[lofter2Jekyll](https://github.com/FromEndWorld/lofter2Jekyll)，源自上面提到过的那个同名脚本。那个脚本我一开始试用是能导出所有的md文档，但是内容都是空的，我痛苦无比地debug了许久，变成了能导出有文字的md，但是图片一张都下不到……继续debug，再然后变成了图片能下到几张，但是遇到有下载失败，程序就停止运行了………牡蛎太太告诉我试试catch语句，我？？？？

要知道我这样的超级半吊子，是只会改代码，不会写代码的！懵逼了许久以后我勇敢地写了笨拙的几行……居然work了？然而我目测try套if的操作可能绝无仅有，是我的笨拙之标志了=，=

这个脚本引用了几个开源的JS包，包括从html转换到md，和从URL批量下载图片什么的，所以转换效果我觉得还是比较满意的，有些出错的图片可能是因为发布的时候图床就不在lofter，然后出于某种原因图本来就挂了，现在脚本也可以跳过这样的情况继续下载了。然后我还修了一些在md里加回车之类的小问题……似乎我自己LOFTER真的集合了很多奇葩状况，很适合作为测试数据源。

总归这番漫长的debug是个极度笨拙但是……挺有趣的过程，最终我得到了一个让我自己可以接受的版本，考虑到原作者两年前的PR都没有pull（我倒是把那个PR的改动用上了），我就重新发布了一遍，拥有了第一个自己的[npm包](https://www.npmjs.com/package/lofter2jekyll)【请鼓掌】

真的，客观来说不是什么大事，但是很有成就感的！目前我看有29次下载，很感谢大家试用我笨拙的代码，真想知道好不好用，能给我提个issue或是pull request的话，do it with style！

以上就是夹带广告的，我所知的三种将lofter导出文件转换成其他博客软件可用的文档的方案。

## 第三步 再发布 


这个其实解决方案就很多了，比如说，咳，[LOFFER](https://github.com/FromEndWorld/LOFFER)。实际上如果你通过它有一点点get了这种操作，与LOFFER类似的Jeykll模板其实比LOFTER的可选主题还有多，不喜欢LOFFER的模样的话可以到这里挑一挑<http://jekyllthemes.org/>

我也试用了一下Hexo，还是蛮好用的，而且详细的步骤教程确实很多，我当时用的是这个<https://zhuanlan.zhihu.com/p/26625249>，一步步搞下来挺顺利的，完全不需要debug，结果我什么也没学会，现在要是想改点啥或者再部署一个，还得再跟着教程一步步做。

下一步我计划分别试一下Hugo和VuePress，如果顺利的话也可以分享一下经验。

这篇废话连篇的指北就这样吧，我坐在电脑前快冻死了，ciao！